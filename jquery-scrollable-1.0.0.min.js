//
// jQuery Scrollable Plugin 
// http://github.com/rehandalal/jquery-scrollable
// Version: 1.0.0
// 
// Create iOS / Mac OS X Lion style fading scrollbars for scrollable elements.
// 
// Copyright (c) 2012, Rehan Dalal
// Licensed under the Unlicense (http://unlicense.org/)
//
(function(a){var b={create:function(b){var c={align:"right",margin:0,railclass:"scrollable_rail",railwidth:8,riderclass:"scrollable_rider",showalways:!1,showrail:!1,wheelstep:32,wrapperclass:"scrollable_wrapper"},d=a.extend(c,b);return this.each(function(){function l(){d.showrail&&i.fadeOut(500),j.fadeOut(500)}function m(a){var c=a.originalEvent,g=c.wheelDelta?c.wheelDelta:c.detail;g/=Math.abs(g);var h=b.scrollTop()+g*d.wheelstep;b.scrollTop(h),j.css({top:d.margin+b.scrollTop()/(d.scrollableHeight-e)*(f-j.height())+"px"})}function n(){d.showrail&&i.fadeIn(150),j.fadeIn(150)}var b=a(this);if(b.data("scrollable")){b.scrollable("destroy"),b.css({height:"",position:"",overflow:""});var c=b.clone();b.parent().after(c),b.parent().remove(),b=c}b.data("scrollable",d);var e=b.height(),f=e-2*d.margin,g=a("<div></div>").addClass(d.wrapperclass).css({height:e,overflow:"hidden",position:"relative",width:b.outerWidth()});b.wrap(g);var h=b.parent(),i=a("<div></div>").addClass(d.railclass).css({bottom:d.margin+"px",display:d.showalways&&d.showrail?"block":"none",left:d.align=="left"?d.margin+"px":"auto",position:"absolute",right:d.align=="right"?d.margin+"px":"auto",top:d.margin+"px",width:d.railwidth+"px",zIndex:1e3}),j=a("<div></div>").addClass(d.riderclass).css({display:d.showalways?"block":"none",left:d.align=="left"?d.margin+"px":"auto",position:"absolute",right:d.align=="right"?d.margin+"px":"auto",top:d.margin+"px",width:d.railwidth+"px",zIndex:2e3});d.rail=i,d.rider=j,b.scrollable("refresh");var k=i.clone().removeClass(d.railclass).css({display:"block",zIndex:0});h.append(k).append(i).append(j),j.draggable({axis:"y",containment:k,start:function(){a(this).data("dragging",!0)},stop:function(){a(this).data("dragging",!1),h.data("hovering")!==!0&&l()},drag:function(){var c=(a(this).position().top-d.margin)/(f-j.height())*(d.scrollableHeight-e);b.scrollTop(c)}}),d.showalways!==!0&&h.hover(function(){h.data("hovering",!0),n()},function(){h.data("hovering",!1),j.data("dragging")!==!0&&l()}),h.on("DOMMouseScroll",m),h.on("mousewheel",m)})},destroy:function(){return this.each(function(){var b=a(this);a(window).unbind(".scrollable"),b.removeData("scrollable")})},refresh:function(){return this.each(function(){var b=a(this),c=b.data("scrollable"),d=b.parent().height(),e=b.scrollTop();b.css({height:"auto",overflow:"visible"}),c.scrollableHeight=b.height(),b.css({height:d,overflow:"hidden"}),b.scrollTop(e);var f=d*d/c.scrollableHeight;f<16&&(f=16),c.rider.css({height:f+"px"}),c.rider.css({top:c.margin+b.scrollTop()/(c.scrollableHeight-d)*(c.rail.height()-c.rider.height())+"px"})})}};a.fn.scrollable=function(c){if(b[c])return b[c].apply(this,Array.prototype.slice.call(arguments,1));if(typeof c=="object"||!c)return b.create.apply(this,arguments);a.error("Method "+c+" does not exist on jQuery.scrollable")}})(jQuery)